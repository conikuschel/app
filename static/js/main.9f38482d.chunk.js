(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{199:function(e,t,n){},368:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),s=n(80),a=n.n(s),i=n(7),r=(n(199),n(191)),d=n(192),l=n(119),j=n.n(l),u=n(177),b=n(190),f=n(370),O=n(371),h=(n(365),n(372)),p=n(373),x=n(1);var m=function(e){var t=e.socket,n=e.username,o=Object(c.useState)(""),s=Object(i.a)(o,2),a=s[0],r=s[1],l=Object(c.useState)([]),m=Object(i.a)(l,2),g=m[0],v=m[1],k=Object(c.useState)({}),y=Object(i.a)(k,2),C=y[0],T=y[1],S=Object(c.useState)([]),w=Object(i.a)(S,2),N=w[0],E=w[1],I=Object(c.useState)({}),F=Object(i.a)(I,2),L=F[0],A=F[1],P=Object(c.useState)(null),R=Object(i.a)(P,2),U=R[0],K=R[1],D=Object(c.useState)(1),H=Object(i.a)(D,2),J=H[0],z=H[1];C==={}&&t.emit("TRUCKS");var B=function(){var e=Object(u.a)(j.a.mark((function e(){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===a){e.next=4;break}return c={message:a,name:n},e.next=4,t.emit("CHAT",c);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(e){var n={code:e};console.log("soyyo"),console.log(e),t.emit("FIX",n)};return Object(c.useEffect)((function(){return t.on("POSITION",(function(e){if(Object.keys(C).length){var t=C;if(t[e.code].position=e.position,e.code in L)L[e.code].setLatLng(e.position);else{var n=L,c=window.L;n[e.code]=c.marker(e.position).addTo(U).bindPopup(e.code),n[e.code].on("mouseover",(function(t){n[e.code].openPopup()})),A(n)}T(t)}})),function(){t.off("POSITION")}}),[C,L]),Object(c.useEffect)((function(){return t.on("FIX",(function(e){if(Object.keys(C).length){var t,n=C;"Ok"!==(null===(t=n[e.code])||void 0===t?void 0:t.states)&&(n[e.code].states="Ok",T(n),console.log(n[e.code].states))}})),function(){t.off("FIX")}}),[C]),Object(c.useEffect)((function(){return t.on("FAILURE",(function(e){if(Object.keys(C).length){var t,n=C;(null===(t=n[e.code])||void 0===t?void 0:t.states)!==e.source&&(n[e.code].states=e.source,T(n),console.log(e))}})),function(){t.off("FAILURE")}}),[C]),Object(c.useEffect)((function(){return t.on("CHAT",(function(e){v((function(t){return[].concat(Object(d.a)(t),[e])}))})),function(){t.off("CHAT")}}),[t]),Object(c.useEffect)((function(){return t.once("TRUCKS",(function(e){if(1===J){var t={};e.forEach((function(e){e.states="Ok",t[e.code]=e})),E(e),T(t),N.forEach((function(e){var t=window.L,n=t.polyline([e.origin,e.destination],{}).addTo(U);t.polylineDecorator(n,{patterns:[{offset:"10%",repeat:"30%",symbol:t.Symbol.arrowHead({pixelSize:15,pathOptions:{fillOpacity:1,weight:0}})}]}).addTo(U),1===J&&(U.panTo(new t.LatLng(e.origin[0],e.origin[1])),z(2))}))}})),function(){t.off("TRUCKS")}}),[C,N,J]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f.a,{center:[-33.27,-70.4],zoom:10,whenCreated:K,children:Object(x.jsx)(O.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})}),Object(x.jsxs)("div",{className:"chat-window",children:[Object(x.jsx)("div",{className:"chat-header",children:Object(x.jsx)("p",{children:"Centro de Control"})}),Object(x.jsx)("div",{className:"chat-body",children:Object(x.jsx)(b.a,{className:"message-container",children:g.map((function(e){return Object(x.jsx)("div",{className:"message",id:n===e.name?"you":"other",children:Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"message-content",children:Object(x.jsx)("p",{children:e.message})}),Object(x.jsxs)("div",{className:"message-meta",children:[Object(x.jsx)("p",{id:"date",children:Date(e.date).substring(0,21)}),Object(x.jsx)("p",{id:"name",children:e.name})]})]})})}))})}),Object(x.jsxs)("div",{className:"chat-footer",children:[Object(x.jsx)("input",{type:"text",value:a,placeholder:"Escribe algo...",onChange:function(e){r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&B()}}),Object(x.jsx)("button",{onClick:B,children:"\u25ba"})]})]}),Object(x.jsx)("div",{class:"card-group",id:"cardis",children:Object.values(C).map((function(e,t){if("Ok"!==e.states)var n="#ffb3b3";else n="#d6f5d6";return Object(x.jsx)(h.a,{style:{width:"18rem",background:n},className:"box",children:Object(x.jsxs)(h.a.Body,{children:[Object(x.jsxs)(h.a.Title,{children:["Cami\xf3n ",e.code]}),Object(x.jsxs)(h.a.Text,{children:["Origen: ",e.origin]}),Object(x.jsxs)(h.a.Text,{children:["Destino: ",e.destination]}),Object(x.jsxs)(h.a.Text,{children:["Estado: ",null===e||void 0===e?void 0:e.states]}),Object(x.jsxs)(h.a.Text,{children:["Capacidad: ",e.capacity]}),Object(x.jsxs)(h.a.Text,{children:["Engine: ",e.engine]}),Object(x.jsxs)(h.a.Text,{children:["Staff: ",JSON.stringify(e.staff[0],null,4)]}),Object(x.jsxs)(h.a.Text,{children:["Truck: ",e.truck]}),"Ok"!==(null===e||void 0===e?void 0:e.states)&&Object(x.jsx)(p.a,{onClick:function(){return X(null===e||void 0===e?void 0:e.code)},variant:"primary",children:"Arreglar"})]})},t)}))})]})},g=(n(367),Object(r.a)("https://tarea-3-websocket.2021-2.tallerdeintegracion.cl",{path:"/trucks/"}));g.on("connect_error",(function(e){console.log("connect_error due to ".concat(e.message))}));var v=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],s=Object(c.useState)(!1),a=Object(i.a)(s,2),r=a[0],d=a[1];return g.emit("TRUCKS"),Object(x.jsx)("div",{className:"App",children:r?Object(x.jsx)(m,{socket:g,username:n}):Object(x.jsxs)("div",{className:"joinChatContainer",children:[Object(x.jsx)("h3",{children:"Control de Camiones"}),Object(x.jsx)("input",{type:"text",placeholder:"Nombre o Nickname...",onChange:function(e){o(e.target.value)}}),Object(x.jsx)("button",{onClick:function(){""!==n&&d(!0)},children:"Join"})]})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,374)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),s(e),a(e)}))};a.a.render(Object(x.jsx)(o.a.StrictMode,{children:Object(x.jsx)(v,{})}),document.getElementById("root")),k()}},[[368,1,2]]]);
//# sourceMappingURL=main.9f38482d.chunk.js.map