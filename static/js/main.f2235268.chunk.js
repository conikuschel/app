(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{199:function(e,t,n){},369:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),a=n(80),s=n.n(a),o=n(11),r=(n(199),n(191)),d=n(192),l=n(119),j=n.n(l),u=n(177),O=n(190),h=n(371),b=n(372),f=(n(365),n(366),n(373)),p=n(374),v=n(1);var x=function(e){var t=e.socket,n=e.username,i=Object(c.useState)(""),a=Object(o.a)(i,2),s=a[0],r=a[1],l=Object(c.useState)([]),x=Object(o.a)(l,2),g=x[0],m=x[1],S=Object(c.useState)([]),y=Object(o.a)(S,2),N=y[0],C=y[1],k=Object(c.useState)({}),w=Object(o.a)(k,2),T=w[0],J=w[1],E=Object(c.useState)(null),F=Object(o.a)(E,2),L=F[0],I=F[1];N===[]&&t.emit("TRUCKS");var A=function(){var e=Object(u.a)(j.a.mark((function e(){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===s){e.next=4;break}return c={message:s,name:n},e.next=4,t.emit("CHAT",c);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function H(e){var n={code:e};t.emit("FIX",n)}return Object(c.useEffect)((function(){t.on("POSITION",(function(e){if(N.length)for(var t=JSON.parse(JSON.stringify(N)),n=0;n<=N.length;n++){var c;if((null===(c=t[n])||void 0===c?void 0:c.code)===e.code){if(t[n].position=e.position,T.length)JSON.parse(JSON.stringify(T));var i={},a=window.L;i[e.code]=a.marker(e.position).addTo(L),J(i),C(t)}}}))}),[N,T]),Object(c.useEffect)((function(){t.on("FIX",(function(e){if(N.length)for(var t=JSON.parse(JSON.stringify(N)),n=0;n<=N.length;n++){var c;(null===(c=t[n])||void 0===c?void 0:c.code)===e.code&&(t[n].states="Ok",C(t))}}))}),[N]),Object(c.useEffect)((function(){t.on("FAILURE",(function(e){if(N.length)for(var t=JSON.parse(JSON.stringify(N)),n=0;n<=N.length;n++){var c;(null===(c=t[n])||void 0===c?void 0:c.code)===e.code&&(t[n].states=e.source,C(t))}}))}),[N]),Object(c.useEffect)((function(){t.on("CHAT",(function(e){m((function(t){return[].concat(Object(d.a)(t),[e])}))}))}),[t]),Object(c.useEffect)((function(){t.on("TRUCKS",(function(e){var t=window.L,n=1;e.forEach((function(e){e.states="Ok"})),C(e),N.forEach((function(e){var c=t.polyline([e.origin,e.destination],{}).addTo(L);t.polylineDecorator(c,{patterns:[{offset:"10%",repeat:"30%",symbol:t.Symbol.arrowHead({pixelSize:15,pathOptions:{fillOpacity:1,weight:0}})}]}).addTo(L),1===n&&(L.panTo(new t.LatLng(e.origin[0],e.origin[1])),n=2)}))}))}),[N]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(h.a,{center:[-33.27,-70.4],zoom:10,whenCreated:I,children:Object(v.jsx)(b.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})}),Object(v.jsxs)("div",{className:"chat-window",children:[Object(v.jsx)("div",{className:"chat-header",children:Object(v.jsx)("p",{children:"Live Chat"})}),Object(v.jsx)("div",{className:"chat-body",children:Object(v.jsx)(O.a,{className:"message-container",children:g.map((function(e){return Object(v.jsx)("div",{className:"message",id:n===e.name?"you":"other",children:Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"message-content",children:Object(v.jsx)("p",{children:e.message})}),Object(v.jsxs)("div",{className:"message-meta",children:[Object(v.jsx)("p",{id:"date",children:e.date}),Object(v.jsx)("p",{id:"name",children:e.name})]})]})})}))})}),Object(v.jsxs)("div",{className:"chat-footer",children:[Object(v.jsx)("input",{type:"text",value:s,placeholder:"Hey...",onChange:function(e){r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&A()}}),Object(v.jsx)("button",{onClick:A,children:"\u25ba"})]})]}),Object(v.jsx)("div",{class:"card-group",id:"cardis",children:N.map((function(e,t){return Object(v.jsx)(f.a,{style:{width:"18rem"},className:"box",children:Object(v.jsxs)(f.a.Body,{children:[Object(v.jsxs)(f.a.Title,{children:["Cami\xf3n ",e.code]}),Object(v.jsxs)(f.a.Text,{children:["Origen: ",e.origin]}),Object(v.jsxs)(f.a.Text,{children:["Destino: ",e.destination]}),Object(v.jsxs)(f.a.Text,{children:["Estado: ",null===e||void 0===e?void 0:e.states]}),"Ok"!==(null===e||void 0===e?void 0:e.states)&&Object(v.jsx)(p.a,{onClick:H(null===e||void 0===e?void 0:e.code),variant:"primary",children:"Arreglar"})]})},t)}))})]})},g=(n(368),Object(r.a)("https://tarea-3-websocket.2021-2.tallerdeintegracion.cl",{path:"/trucks/"}));g.on("connect_error",(function(e){console.log("connect_error due to ".concat(e.message))}));var m=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],i=t[1],a=Object(c.useState)(!1),s=Object(o.a)(a,2),r=s[0],d=s[1];return g.emit("TRUCKS"),Object(v.jsx)("div",{className:"App",children:r?Object(v.jsx)(x,{socket:g,username:n}):Object(v.jsxs)("div",{className:"joinChatContainer",children:[Object(v.jsx)("h3",{children:"Join A Chat"}),Object(v.jsx)("input",{type:"text",placeholder:"John...",onChange:function(e){i(e.target.value)}}),Object(v.jsx)("button",{onClick:function(){""!==n&&d(!0)},children:"Join"})]})})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,375)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),i(e),a(e),s(e)}))};s.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(m,{})}),document.getElementById("root")),S()}},[[369,1,2]]]);
//# sourceMappingURL=main.f2235268.chunk.js.map