(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{199:function(e,t,n){},369:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(80),s=n.n(i),r=n(11),o=(n(199),n(191)),d=n(192),j=n(119),l=n.n(j),u=n(177),b=n(190),h=n(371),O=n(372),p=(n(365),n(366),n(373)),f=n(374),x=n(1);var m=function(e){var t=e.socket,n=e.username,a=Object(c.useState)(""),i=Object(r.a)(a,2),s=i[0],o=i[1],j=Object(c.useState)([]),m=Object(r.a)(j,2),v=m[0],g=m[1],y=Object(c.useState)([]),S=Object(r.a)(y,2),C=S[0],w=S[1],N=Object(c.useState)({}),T=Object(r.a)(N,2),k=T[0],J=T[1],E=Object(c.useState)(null),L=Object(r.a)(E,2),F=L[0],A=L[1];C===[]&&t.emit("TRUCKS");var I=function(){var e=Object(u.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===s){e.next=4;break}return c={message:s,name:n},e.next=4,t.emit("CHAT",c);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function H(e){var n={code:e};t.emit("FIX",n)}return Object(c.useEffect)((function(){t.on("POSITION",(function(e){if(C.length)for(var t=JSON.parse(JSON.stringify(C)),n=0;n<=C.length;n++){var c;if((null===(c=t[n])||void 0===c?void 0:c.code)===e.code){if(t[n].position=e.position,k.length)JSON.parse(JSON.stringify(k));var a={},i=window.L;a[e.code]=i.marker(e.position).addTo(F),J(a),w(t)}}}))}),[C,k]),Object(c.useEffect)((function(){t.on("CHAT",(function(e){g((function(t){return[].concat(Object(d.a)(t),[e])}))}))}),[t]),Object(c.useEffect)((function(){t.on("TRUCKS",(function(e){var t=window.L,n=1;e.forEach((function(e){e.states="Ok"})),w(e),C.forEach((function(e){var c=t.polyline([e.origin,e.destination],{}).addTo(F);t.polylineDecorator(c,{patterns:[{offset:"10%",repeat:"30%",symbol:t.Symbol.arrowHead({pixelSize:15,pathOptions:{fillOpacity:1,weight:0}})}]}).addTo(F),1===n&&(F.panTo(new t.LatLng(e.origin[0],e.origin[1])),n=2)}))}))}),[C]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(h.a,{center:[-33.27,-70.4],zoom:10,whenCreated:A,children:Object(x.jsx)(O.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})}),Object(x.jsxs)("div",{className:"chat-window",children:[Object(x.jsx)("div",{className:"chat-header",children:Object(x.jsx)("p",{children:"Live Chat"})}),Object(x.jsx)("div",{className:"chat-body",children:Object(x.jsx)(b.a,{className:"message-container",children:v.map((function(e){return Object(x.jsx)("div",{className:"message",id:n===e.name?"you":"other",children:Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"message-content",children:Object(x.jsx)("p",{children:e.message})}),Object(x.jsxs)("div",{className:"message-meta",children:[Object(x.jsx)("p",{id:"date",children:e.date}),Object(x.jsx)("p",{id:"name",children:e.name})]})]})})}))})}),Object(x.jsxs)("div",{className:"chat-footer",children:[Object(x.jsx)("input",{type:"text",value:s,placeholder:"Hey...",onChange:function(e){o(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&I()}}),Object(x.jsx)("button",{onClick:I,children:"\u25ba"})]})]}),Object(x.jsx)("div",{class:"card-group",id:"cardis",children:C.map((function(e,t){return Object(x.jsx)(p.a,{style:{width:"18rem"},className:"box",children:Object(x.jsxs)(p.a.Body,{children:[Object(x.jsxs)(p.a.Title,{children:["Cami\xf3n ",e.code]}),Object(x.jsxs)(p.a.Text,{children:["Origen: ",e.origin]}),Object(x.jsxs)(p.a.Text,{children:["Destino: ",e.destination]}),Object(x.jsxs)(p.a.Text,{children:["Estado: ",null===e||void 0===e?void 0:e.states]}),"Ok"!==(null===e||void 0===e?void 0:e.states)&&Object(x.jsx)(f.a,{onClick:H(null===e||void 0===e?void 0:e.code),variant:"primary",children:"Arreglar"})]})},t)}))})]})},v=(n(368),Object(o.a)("https://tarea-3-websocket.2021-2.tallerdeintegracion.cl",{path:"/trucks/"}));v.on("connect_error",(function(e){console.log("connect_error due to ".concat(e.message))}));var g=function(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(!1),s=Object(r.a)(i,2),o=s[0],d=s[1];return v.emit("TRUCKS"),Object(x.jsx)("div",{className:"App",children:o?Object(x.jsx)(m,{socket:v,username:n}):Object(x.jsxs)("div",{className:"joinChatContainer",children:[Object(x.jsx)("h3",{children:"Join A Chat"}),Object(x.jsx)("input",{type:"text",placeholder:"John...",onChange:function(e){a(e.target.value)}}),Object(x.jsx)("button",{onClick:function(){""!==n&&d(!0)},children:"Join"})]})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,375)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(g,{})}),document.getElementById("root")),y()}},[[369,1,2]]]);
//# sourceMappingURL=main.d5821c03.chunk.js.map